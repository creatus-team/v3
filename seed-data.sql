-- =====================================================
-- RCCC 테스트 데이터
-- Supabase SQL Editor에서 실행
-- =====================================================

-- =====================================================
-- 1. 코치 3명
-- =====================================================
INSERT INTO coaches (id, name, phone, grade, bank_account, max_slots) VALUES
  ('c1000000-0000-0000-0000-000000000001', '김다혜', '01011111111', 'REGULAR', '국민 123-456-789012', 10),
  ('c1000000-0000-0000-0000-000000000002', '박민수', '01022222222', 'SENIOR', '신한 987-654-321098', 10),
  ('c1000000-0000-0000-0000-000000000003', '이지은', '01033333333', 'TRAINEE', '우리 111-222-333444', 5);

-- =====================================================
-- 2. 슬롯 (코치별 2~3개씩)
-- =====================================================
-- 김다혜 코치 슬롯
INSERT INTO coach_slots (id, coach_id, day_of_week, start_time, end_time, open_chat_link, is_active) VALUES
  ('s1000000-0000-0000-0000-000000000001', 'c1000000-0000-0000-0000-000000000001', '화', '19:00', '19:40', 'https://open.kakao.com/dahye1', true),
  ('s1000000-0000-0000-0000-000000000002', 'c1000000-0000-0000-0000-000000000001', '목', '19:00', '19:40', 'https://open.kakao.com/dahye2', true),
  ('s1000000-0000-0000-0000-000000000003', 'c1000000-0000-0000-0000-000000000001', '토', '10:00', '10:40', 'https://open.kakao.com/dahye3', true);

-- 박민수 코치 슬롯
INSERT INTO coach_slots (id, coach_id, day_of_week, start_time, end_time, open_chat_link, is_active) VALUES
  ('s1000000-0000-0000-0000-000000000004', 'c1000000-0000-0000-0000-000000000002', '월', '20:00', '20:40', 'https://open.kakao.com/minsu1', true),
  ('s1000000-0000-0000-0000-000000000005', 'c1000000-0000-0000-0000-000000000002', '수', '20:00', '20:40', 'https://open.kakao.com/minsu2', true),
  ('s1000000-0000-0000-0000-000000000006', 'c1000000-0000-0000-0000-000000000002', '금', '18:00', '18:40', 'https://open.kakao.com/minsu3', true);

-- 이지은 코치 슬롯
INSERT INTO coach_slots (id, coach_id, day_of_week, start_time, end_time, open_chat_link, is_active) VALUES
  ('s1000000-0000-0000-0000-000000000007', 'c1000000-0000-0000-0000-000000000003', '화', '10:00', '10:40', 'https://open.kakao.com/jieun1', true),
  ('s1000000-0000-0000-0000-000000000008', 'c1000000-0000-0000-0000-000000000003', '금', '14:00', '14:40', 'https://open.kakao.com/jieun2', true);

-- =====================================================
-- 3. 수강생 5명
-- =====================================================
INSERT INTO users (id, name, phone, email, memo, is_manual_entry) VALUES
  ('u1000000-0000-0000-0000-000000000001', '홍길동', '01012345678', 'hong@email.com', '저녁 시간 선호', false),
  ('u1000000-0000-0000-0000-000000000002', '김철수', '01087654321', 'kim@email.com', NULL, false),
  ('u1000000-0000-0000-0000-000000000003', '이영희', '01055556666', 'lee@email.com', '주말 연락 불가', false),
  ('u1000000-0000-0000-0000-000000000004', '박지민', '01077778888', NULL, NULL, true),
  ('u1000000-0000-0000-0000-000000000005', '최수진', '01099990000', 'choi@email.com', '연장 의사 있음', false);

-- =====================================================
-- 4. 세션 (수강 이력)
-- =====================================================
-- 홍길동: 김다혜 코치 화요일 - 수강중 (ACTIVE)
INSERT INTO sessions (id, user_id, coach_id, slot_id, day_of_week, start_time, start_date, end_date, extension_count, status, payment_amount, payment_date, product_name) VALUES
  ('ss100000-0000-0000-0000-000000000001', 'u1000000-0000-0000-0000-000000000001', 'c1000000-0000-0000-0000-000000000001', 's1000000-0000-0000-0000-000000000001', '화', '19:00', '2025-01-14', '2025-02-10', 2, 'ACTIVE', 400000, '2025-01-10', '래피드코칭 4회');

-- 김철수: 박민수 코치 월요일 - 수강중 (ACTIVE), 종료 임박
INSERT INTO sessions (id, user_id, coach_id, slot_id, day_of_week, start_time, start_date, end_date, extension_count, status, payment_amount, payment_date, product_name) VALUES
  ('ss100000-0000-0000-0000-000000000002', 'u1000000-0000-0000-0000-000000000002', 'c1000000-0000-0000-0000-000000000002', 's1000000-0000-0000-0000-000000000004', '월', '20:00', '2025-01-06', '2025-01-27', 0, 'ACTIVE', 500000, '2025-01-03', '래피드코칭 4회 (선임)');

-- 이영희: 이지은 코치 화요일 - 대기 (PENDING)
INSERT INTO sessions (id, user_id, coach_id, slot_id, day_of_week, start_time, start_date, end_date, extension_count, status, payment_amount, payment_date, product_name) VALUES
  ('ss100000-0000-0000-0000-000000000003', 'u1000000-0000-0000-0000-000000000003', 'c1000000-0000-0000-0000-000000000003', 's1000000-0000-0000-0000-000000000007', '화', '10:00', '2025-01-28', '2025-02-24', 0, 'PENDING', 400000, '2025-01-20', '래피드코칭 4회');

-- 박지민: 김다혜 코치 목요일 - 수강중 (ACTIVE)
INSERT INTO sessions (id, user_id, coach_id, slot_id, day_of_week, start_time, start_date, end_date, extension_count, status, payment_amount, payment_date, product_name) VALUES
  ('ss100000-0000-0000-0000-000000000004', 'u1000000-0000-0000-0000-000000000004', 'c1000000-0000-0000-0000-000000000001', 's1000000-0000-0000-0000-000000000002', '목', '19:00', '2025-01-09', '2025-02-05', 1, 'ACTIVE', 400000, '2025-01-05', '래피드코칭 4회');

-- 최수진: 과거 세션 (종료됨)
INSERT INTO sessions (id, user_id, coach_id, slot_id, day_of_week, start_time, start_date, end_date, extension_count, status, payment_amount, payment_date, product_name) VALUES
  ('ss100000-0000-0000-0000-000000000005', 'u1000000-0000-0000-0000-000000000005', 'c1000000-0000-0000-0000-000000000002', 's1000000-0000-0000-0000-000000000005', '수', '20:00', '2024-12-01', '2024-12-28', 0, 'EXPIRED', 500000, '2024-11-28', '래피드코칭 4회 (선임)');

-- =====================================================
-- 5. 연기 기록
-- =====================================================
INSERT INTO postponements (session_id, postponed_date, reason) VALUES
  ('ss100000-0000-0000-0000-000000000001', '2025-01-21', '수강생 개인 사정'),
  ('ss100000-0000-0000-0000-000000000004', '2025-01-16', '코치 휴무');

-- =====================================================
-- 6. 활동 로그
-- =====================================================
INSERT INTO user_activity_logs (user_id, session_id, action_type, reason, metadata) VALUES
  ('u1000000-0000-0000-0000-000000000001', 'ss100000-0000-0000-0000-000000000001', 'ENROLL', NULL, '{"source": "latpeed"}'),
  ('u1000000-0000-0000-0000-000000000001', 'ss100000-0000-0000-0000-000000000001', 'RENEWAL', NULL, '{"extension_count": 2}'),
  ('u1000000-0000-0000-0000-000000000001', 'ss100000-0000-0000-0000-000000000001', 'POSTPONE', '수강생 개인 사정', '{"postponed_date": "2025-01-21"}'),
  ('u1000000-0000-0000-0000-000000000002', 'ss100000-0000-0000-0000-000000000002', 'ENROLL', NULL, '{"source": "latpeed"}'),
  ('u1000000-0000-0000-0000-000000000003', 'ss100000-0000-0000-0000-000000000003', 'ENROLL', NULL, '{"source": "latpeed"}'),
  ('u1000000-0000-0000-0000-000000000004', 'ss100000-0000-0000-0000-000000000004', 'ENROLL', '수동등록 - 현금결제', '{"manual": true}');

-- =====================================================
-- 7. 시스템 로그
-- =====================================================
INSERT INTO system_logs (event_type, status, message, process_status, raw_data) VALUES
  ('WEBHOOK_RECEIVED', 'SUCCESS', '웹훅 수신 성공: 홍길동', 'SUCCESS', '{"name": "홍길동", "phone": "01012345678"}'),
  ('SESSION_CREATED', 'SUCCESS', '세션 생성: 홍길동 → 김다혜/화/19:00', 'SUCCESS', NULL),
  ('SMS_SENT', 'SUCCESS', '문자 발송 성공: 01012345678', 'SUCCESS', NULL),
  ('SMS_FAILED', 'FAILED', '문자 발송 실패: 01099999999 (잘못된 번호)', 'PENDING', '{"error": "Invalid phone number"}'),
  ('PARSE_FAILED', 'FAILED', '파싱 실패: 김다혜 / 화요일 / 19시', 'PENDING', '{"raw": "김다혜 / 화요일 / 19시"}');

-- =====================================================
-- 8. 인박스 (처리 필요한 데이터)
-- =====================================================
INSERT INTO ingestion_inbox (raw_text, error_message, error_type, manual_resolution_status) VALUES
  ('김다혜 / 화요일 / 19시', '시간 형식 오류 - HH:MM 형식이어야 함', 'PARSE_FAILED', 'PENDING'),
  ('박영수 / 화 / 19:00', '슬롯 충돌 - 김다혜/화/19:00 이미 사용중', 'SLOT_CONFLICT', 'PENDING');

-- =====================================================
-- 완료!
-- =====================================================
